---
title: 兼容浏览器新特性
date: 2017-10-24 11:32:31
tags:
- 前端
- javascript
categories:
- 笔记
- 前端
- javascript
---

[http://blog.csdn.net/zhangxin09/article/details/17679113](http://blog.csdn.net/zhangxin09/article/details/17679113)

<!--more-->

---
- 控制台 调试用的方法 console.log()/dir()/warn()
```
if(!this.console){ // 用 this 代替 window 更通用，可在一些非浏览器的 js 环境中使用，例如 ASP in JScript  
    this.console = {  
        log : alert  
    }  
}  
if(!console.dir){  
    console.dir = console.log;  
}  
```
 
- Object.create() 创建对象， 而不使用new创建对象
```
if (!Object.create){  
    Object.create = function (o) {  
        if (arguments.length > 1) {  
            throw new Error('Object.create implementation only accepts the first parameter.');  
        }  
        function F() {}  
        F.prototype = o;  
        return new F();  
    };  
} 
```
- String.prototype.format()
```
String.prototype.format = function () {  
    var str = this;   
    if(typeof(arguments[0]) == 'string'|| typeof(arguments[0]) == 'number'){  
        for(var i = 0, j = arguments.length; i < j; i++){  
            str = str.replace(new RegExp('\\{' + i +'\\}', 'g'), arguments[i]);  
        }  
    }else{  
        for(var i in arguments[0]){  
            str = str.replace(new RegExp('\\{' + i +'\\}', 'g'), arguments[0][i]); // 大小写敏感  
        }  
    }  
  
    return str;  
} 
```

- ExplorerCanvas 让IE支持canvas标签
[http://code.google.com/p/explorercanvas/](http://code.google.com/p/explorercanvas/)

- 兼容Placeholder
[https://github.com/NV/placeholder.js](https://github.com/NV/placeholder.js)

- 兼容JSON的stringify 和 parse 方法
[https://github.com/douglascrockford/JSON-js](https://github.com/douglascrockford/JSON-js)

- yepnope 按特定条件加载script和css
[http://yepnopejs.com/](http://yepnopejs.com/)

- ES5-Shim
[https://github.com/kriskowal/es5-shim/](https://github.com/kriskowal/es5-shim/)

- thumbs.js web端兼容触摸事件
[http://mwbrooks.github.com/thumbs.js/](http://mwbrooks.github.com/thumbs.js/)

- Base64.js
[https://github.com/davidchambers/Base64.js](https://github.com/davidchambers/Base64.js)
```
;(function () {

  var object =
    typeof exports != 'undefined' ? exports :
    typeof self != 'undefined' ? self : // #8: web workers
    $.global; // #31: ExtendScript

  var chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';

  function InvalidCharacterError(message) {
    this.message = message;
  }
  InvalidCharacterError.prototype = new Error;
  InvalidCharacterError.prototype.name = 'InvalidCharacterError';

  // encoder
  // [https://gist.github.com/999166] by [https://github.com/nignag]
  object.btoa || (
  object.btoa = function (input) {
    var str = String(input);
    for (
      // initialize result and counter
      var block, charCode, idx = 0, map = chars, output = '';
      // if the next str index does not exist:
      //   change the mapping table to "="
      //   check if d has no fractional digits
      str.charAt(idx | 0) || (map = '=', idx % 1);
      // "8 - idx % 1 * 8" generates the sequence 2, 4, 6, 8
      output += map.charAt(63 & block >> 8 - idx % 1 * 8)
    ) {
      charCode = str.charCodeAt(idx += 3/4);
      if (charCode > 0xFF) {
        throw new InvalidCharacterError("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");
      }
      block = block << 8 | charCode;
    }
    return output;
  });

  // decoder
  // [https://gist.github.com/1020396] by [https://github.com/atk]
  object.atob || (
  object.atob = function (input) {
    var str = String(input).replace(/[=]+$/, ''); // #31: ExtendScript bad parse of /=
    if (str.length % 4 == 1) {
      throw new InvalidCharacterError("'atob' failed: The string to be decoded is not correctly encoded.");
    }
    for (
      // initialize result and counters
      var bc = 0, bs, buffer, idx = 0, output = '';
      // get next character
      buffer = str.charAt(idx++);
      // character found in table? initialize bit storage and add its ascii value;
      ~buffer && (bs = bc % 4 ? bs * 64 + buffer : buffer,
        // and if not first of each 4 characters,
        // convert the first 8 bits to one ascii character
        bc++ % 4) ? output += String.fromCharCode(255 & bs >> (-2 * bc & 6)) : 0
    ) {
      // try to find character in table (0-63, not found => -1)
      buffer = chars.indexOf(buffer);
    }
    return output;
  });

}());
```